# .ruff.toml â€” WMS-DU stable & backward-compatible config
# =======================================================
# ä¸ Makefile / pre-commit é…åˆä½¿ç”¨ï¼Œæ”¯æŒæ—§ç‰ˆ Ruffï¼ˆ0.5.x~0.6.xï¼‰ã€‚

# Python ç‰ˆæœ¬
target-version = "py312"
line-length = 100
indent-width = 4

# æ‰«æè·¯å¾„
src = ["app", "tests", "scripts", "tools"]

# =======================================================
# ğŸ” ä¸»è§„åˆ™é›†
# =======================================================
[lint]
select = [
  "E",   # pycodestyle
  "F",   # pyflakes
  "I",   # isort
  "B",   # flake8-bugbear
  "SIM", # flake8-simplify
  "PL",  # pylint-like
  "RUF", # ruff è‡ªèº«è§„åˆ™
]

# å¿½ç•¥é¡¹ï¼ˆå¯é€æ­¥æ”¶ç´§ï¼‰
ignore = [
  "E501",     # è¡Œè¿‡é•¿äº¤ç»™ black
  "PLR0912",  # åˆ†æ”¯è¿‡å¤š
  "PLR0913",  # å‚æ•°è¿‡å¤š
  "PLR2004",  # Magic numbers
  "PLW0603",  # global
  "B008",     # FastAPI Depends é»˜è®¤å‚æ•°
  "B007",     # æœªä½¿ç”¨å¾ªç¯å˜é‡
  "SIM117",   # åµŒå¥— with
  "SIM118",   # â€œRewrite using dict()â€
]

# =======================================================
# ğŸ“ æŒ‰ç›®å½•è±å…
# =======================================================
# - testsï¼šå¿½ç•¥ä¸­æ–‡æ ‡ç‚¹ï¼ˆRUF001/2/3ï¼‰å’Œé•¿è¡Œï¼ˆE501ï¼‰
# - alembic/versionsï¼šå¿½ç•¥å¤æ‚åˆ†æ”¯å’Œ contextlib æç¤º
per-file-ignores = {
  "tests/**/*.py" = ["RUF001", "RUF002", "RUF003", "E501"],
  "alembic/**/*.py" = ["PLR0912", "SIM105"],
}

# =======================================================
# âš™ï¸ isort è®¾ç½®ï¼ˆæ—§ç‰ˆ Ruff å…¼å®¹å­—æ®µï¼‰
# =======================================================
[lint.isort]
combine-as-imports = true
force-sort-within-sections = true
order-by-type = false
known-first-party = ["app"]
lines-after-imports = 2
from-first = false
case-sensitive = false

# =======================================================
# ğŸ§© å…¶ä»–é€‰é¡¹ï¼ˆå¯é€‰ï¼‰
# =======================================================
# è‹¥æœ‰ false-positiveï¼Œå¯åŠ ï¼š
# ignore-init-module-imports = true
# extend-exclude = ["_archive__", "_alembic_bak"]
