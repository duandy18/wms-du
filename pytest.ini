# pytest.ini
# wms-du/pytest.ini
[pytest]
# 测试搜索路径
testpaths = tests

# 常用选项（安静输出）
addopts = -q -s

# === 注册自定义标记，消除 Unknown mark 警告 ===
markers =
    quick: quick 针刺测试
    smoke: smoke 冒烟测试

# === asyncio 模式：自动管理事件循环，消除异步相关警告 ===
# 若有自定义异步 fixture（如 _reset_db），建议使用 @pytest_asyncio.fixture 装饰器
asyncio_mode = auto

# 解决警告：Unknown config option: env
# 需要安装插件 pytest-env（pip install pytest-env）
# 解决警告：Unknown config option: env
# 需要安装插件 pytest-env
# pip install pytest-env
env =
    PYTHONPATH=.
    DATABASE_URL=postgresql+psycopg://wms:wms@127.0.0.1:5433/wms
    JWT_SECRET=test-ci-secret
