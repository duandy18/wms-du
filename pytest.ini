[pytest]
# 只收集主用例目录，排除 quick 套件（避免收集期 ImportError 影响 grp_scan）
testpaths = tests
norecursedirs = tests/quick

# 常用运行选项（保持简洁输出；需要时命令行再加 -m grp_scan）
addopts = -q

# pytest-asyncio 自动模式（兼容 @pytest.mark.asyncio）
asyncio_mode = auto

# 注册所有分组标记，消除 UnknownMark 警告
markers =
    grp_events: C组 / 事件链路用例
    grp_core: A组 / 核心口径与FEFO
    grp_flow: B组 / 流程闭环
    grp_reverse: B组 / 逆向与预留
    grp_snapshot: 快照与口径护栏
    grp_scan: 扫码通路契约（probe + real）
    smoke: 轻量冒烟用例
    quick: 临时/快速用例集（默认不收集）

# 过滤外部库弃用告警等噪声
filterwarnings =
    ignore::DeprecationWarning:fastapi\..*
    ignore::DeprecationWarning:starlette\..*
    ignore::DeprecationWarning:asyncpg\..*
    ignore::DeprecationWarning:pydantic\..*
